//#define _CRTDBG_MAP_ALLOC
//#include <stdlib.h>
//#include <crtdbg.h>

#include <iostream>
#include <vector>
#include <string>
#include <utility>
#include <algorithm>
#include <vld.h>

using namespace std;

class Parking;

class Car {
public:
    string number{}, make{}, colour{};

    Car(string number, string make, string colour) {
        this->number = number;
        this->make = make;
        this->colour = colour;
    }

    void parking(Parking& parkingLot);

    void leave(Parking& parkingLot);

    ~Car() {};
};

class Parking {
public:
    vector<pair<Car, bool>> cars{};

    void printParkedCars() {
        int flag = 0;
        for (int i = 0; i < cars.size(); i++) {
            if (cars[i].second) {
                if (!flag) {
                    cout << "Parked cars:" << endl;
                    flag = 1;
                }
                cout << "Number: " << cars[i].first.number << endl;
                cout << "Make: " << cars[i].first.make << endl;
                cout << "Color: " << cars[i].first.colour << endl;
            }
            cout << endl;
        }
    }

    void isParked(Car car) {
        //  Поиск машины с определенным номером
        auto it = find_if(cars.begin(), cars.end(),
            [car](const pair<Car, bool>& carPair) {
                return carPair.first.number == car.number;
            });
        if (it != cars.end()) {
            cout << "Car with number " << car.number << " is parked" << endl;
        }
        else {
            cout << "Car with number " << car.number << " is not parked" << endl;
        }
    }

    ~Parking() {};
};

void Car::parking(Parking& parkingLot) {
    //  Поиск машины с определенным номером, для того поменять метку присутствия на парковке
    auto it = find_if(parkingLot.cars.begin(), parkingLot.cars.end(),
        [this](const pair<Car, bool>& carPair) {
            return carPair.first.number == this->number;
        });

    if (it == parkingLot.cars.end()) {
        parkingLot.cars.push_back(make_pair(*this, true));
    }
    else {
        parkingLot.cars[it - parkingLot.cars.begin()].second = true;
    }
}

void Car::leave(Parking& parkingLot) {
    //  Поиск машины с определенным номером, для того поменять метку присутствия на парковке
    auto it = find_if(parkingLot.cars.begin(), parkingLot.cars.end(),
        [this](const pair<Car, bool>& carPair) {
            return carPair.first.number == this->number;
        });
    
    if (it != parkingLot.cars.end()) {
        parkingLot.cars[it - parkingLot.cars.begin()].second = false;
    }
}

int main() {
    Parking parkingLot{};

    Car car1("A126AA_26", "BMW", "blue");
    Car car2("E707KA_23", "Nissan", "grey");
    Car car3("A005AA_05", "Lada", "black");
    Car car4("T777TT_777", "Ferrari", "red");
    Car car5("T136AT_126", "Mercedes-Benz", "black");
    Car car6("O777OO_123", "Toyota", "purple");
    Car car7("E025EA_05", "Suzuki", "yellow");
    Car car8("H7117TH_09", "Land Lover", "pink");
    Car car9("K005BB_25", "Jaguar", "green");
    Car car10("T100PP_07", "Audi", "white");

    car1.parking(parkingLot);
    car2.parking(parkingLot);
    car3.parking(parkingLot);
    car4.parking(parkingLot);
    car5.parking(parkingLot);
    car6.parking(parkingLot);
    car7.parking(parkingLot);
    car8.parking(parkingLot);
    car9.parking(parkingLot);
    car10.parking(parkingLot);

    parkingLot.isParked(car7);

    car1.leave(parkingLot);
    parkingLot.printParkedCars();

    //    _CrtSetReportMode(_CRT_WARN, _CRTDBG_MODE_DEBUG);
    //    _CrtDumpMemoryLeaks();
    return 0;
}
